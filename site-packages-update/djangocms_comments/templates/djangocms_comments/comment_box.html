{% load bootstrap3 comments_utils %}
{% load i18n %}

{% comment %}
<div class="comment-box{% if comment %} success-form{% endif %}">
    {% if comment %}
        <div class="comment-success">
            {% include "djangocms_comments/comment.html" with comment=comment %}
        </div>
    {% endif %}
    <form action="{% url 'djangocms_comments_save_comment' %}" method="post" class="comment-box-form">
        {% csrf_token %}
        {% if comment %}
            {% bootstrap_alert "Your comment has been sent" alert_type="success" %}
        {% endif %}
        {% if is_user %}
        <div class="row">
            <div class="col-md-24">
                <img src="http://www.gravatar.com/avatar/{{ request.user.email|md5 }}" class="avatar" />
                <div>
                    <strong>{{ request.user }}</strong>
                    {% if request.user.is_staff %}<span class="label label-primary">Staff</span>{% endif %}
                </div>
                <div>X comments</div>
            </div>
        </div>
        {% else %}
        <div class="row">
            <div class="col-md-19">
                {% bootstrap_field form.username show_label=false horizontal_label_class='col-md-0' %}
                {% bootstrap_field form.email show_label=false horizontal_label_class='col-md-0' %}
                {% bootstrap_field form.website show_label=false horizontal_label_class='col-md-0' %}
            </div>
            <div class="col-md-5">
                <img src="http://www.gravatar.com/avatar/?s=150&d=mm" class="avatar dynamic-gravatar" />
            </div>
        </div>
        {% endif %}
        <div class="row">
            {% bootstrap_form_errors form %}
            <div class="col-md-24">{% bootstrap_field form.body show_label=false %}</div>
        </div>
        {{ form.config_id }}
        {{ form.page_type }}
        {{ form.page_id }}
        {% bootstrap_button "Submit" button_type="submit" %}
    </form>
</div>
{% endcomment %}

  <!-- Main Content -->

  <div class="row">
    <div class="col-sm-12">
      <div class="comment-box {% if comment %} success-form{% endif %}">
          {% if comment %}
            <div class="comment-success">
                {% include "djangocms_comments/comment.html" with comment=comment %}
            </div>
          {% endif %}

          <!-- <form action="{% url 'djangocms_comments_save_comment' %}" method="post" class="comment-box-form" novalidate> -->
          <form action="{% url 'djangocms_comments_save_comment' %}" method="post" class="comment-box-form">
            {% csrf_token %}
            {% if comment %}
                {% bootstrap_alert "Your comment has been sent" alert_type="success" %}
            {% endif %}

            {% if is_user %}
            <div class="row">
                <div class="col-sm-12">
                    <div>
                        <strong>{{ request.user }}</strong>
                        {% if request.user.is_staff %}<span class="label label-primary">Staff</span>{% endif %}
                    </div>
                </div>
            </div>
            {% else %}
            <div class="row">
                <div class="col-sm-12">
                
                    <p>留言请先<a href="{% url 'login' %}"> 登录</a>! </p>
                    
                    {% comment %}

                    <!-- {% bootstrap_field form.username show_label=false horizontal_label_class='col-md-0' %}
                    {% bootstrap_field form.email show_label=false horizontal_label_class='col-md-0' %}
                    {% bootstrap_field form.website show_label=false horizontal_label_class='col-md-0' %} -->

                    {% fields_cleanblog_render form.username show_label=false type="text" valid_message="Please enter your name." %}  
                    {% fields_cleanblog_render form.email show_label=false type="email" valid_message="Please enter your email address." %}
                    {# fields_cleanblog_render form.website show_label=false type="tel" horizontal_label_class='col-xs-12' valid_message="Please enter your website." #}

                    <!-- <div class="control-group">
                      <div class="form-group floating-label-form-group controls">
                        <label for="id_username">Username</label>
                        <input type="text" class="form-control" placeholder="Username" id="id_username" name="username" required data-validation-required-message="Please enter your name.">
                        <p class="help-block text-danger"></p>
                      </div>
                    </div>
                    <div class="control-group">
                      <div class="form-group floating-label-form-group controls">
                        <label for="id_email">Email Address</label>
                        <input type="email" class="form-control" placeholder="Email Address" id="id_email" name="email" required data-validation-required-message="Please enter your email address.">
                        <p class="help-block text-danger"></p>
                      </div>
                    </div>
                    <div class="control-group">
                      <div class="form-group floating-label-form-group controls col-xs-12 ">
                        <label for="id_website">Website</label>
                        <input type="tel" class="form-control" placeholder="Website" id="id_website" name="website" required data-validation-required-message="Please enter your website.">
                        <p class="help-block text-danger"></p>
                      </div>
                    </div> -->
                    {% endcomment %}
                </div>
            </div>
            {% endif %}
        
            {% bootstrap_form_errors form %}
            <div class="control-group">
              <div class="form-group floating-label-form-group controls">
                <label for="id_body">{% trans 'Your Comments' %}</label>
                <textarea rows="5" class="form-control" placeholder="Message" id="id_body" name="body" maxlength="12000" minlength="5" required data-validation-required-message="Please enter a message."></textarea>
                <p class="help-block text-danger"></p>
              </div>
            </div>

            {{ form.config_id }}
            {{ form.page_type }}
            {{ form.page_id }}

            <br>
            <div id="success"></div>
            <div class="form-group">
              <button type="submit" class="btn btn-primary" id="sendMessageButton">Send</button>
            </div>
          </form>
      </div>
    </div>
  </div>
<br>
